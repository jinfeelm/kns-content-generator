<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KNS 카페 콘텐츠 생성기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 10px; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .blinking-cursor {
            display: inline-block;
            width: 8px;
            height: 1.2em;
            background-color: #60a5fa;
            animation: blink 1s step-end infinite;
            margin-left: 2px;
            vertical-align: bottom;
        }
        @keyframes blink {
            from, to { background-color: transparent; }
            50% { background-color: #60a5fa; }
        }
        [contenteditable]:empty:before {
            content: attr(placeholder);
            pointer-events: none;
            display: block;
            color: #64748b;
        }
        /* 드래그 앤 드롭 시각적 피드백 스타일 */
        .drag-over {
            border-style: dashed !important;
            border-color: #34d399 !important;
            transform: scale(1.01);
        }
        /* 도움말 모달 스타일 */
        #helpModal ul { list-style-position: inside; }
        #helpModal li { margin-bottom: 0.5rem; }
        #helpModal strong { color: #60a5fa; }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 antialiased">

    <div class="container mx-auto p-4 md:p-8 min-h-screen flex flex-col">
        <!-- Header -->
        <header class="text-center mb-8 md:mb-12 relative">
            <h1 class="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-sky-400 to-emerald-400">KNS 카페 콘텐츠 생성기</h1>
            <p class="text-slate-400 text-lg">OBT <span class="text-xs ml-1 px-2 py-0.5 bg-sky-500/20 text-sky-400 rounded-full">w. Gemini</span></p>
            <button id="helpBtn" class="absolute top-0 right-0 bg-slate-700 text-sm py-1 px-3 rounded-md hover:bg-slate-600">❔ 도움말</button>
        </header>

        <!-- Main Content -->
        <main class="flex-grow grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Control Panel -->
            <div class="bg-slate-800 p-6 rounded-2xl shadow-lg border border-slate-700 flex flex-col">
                <div class="space-y-6 flex-grow">
                    <!-- 1. Persona Selection -->
                    <div>
                        <label for="persona" class="block text-lg font-bold text-slate-300 mb-2">1. 페르소나 선택</label>
                        <p class="text-sm text-slate-400 mb-3">담당 학년에 맞는 엄마를 선택해주세요.</p>
                        <select id="persona" class="w-full bg-slate-700 border border-slate-600 rounded-lg py-2.5 px-3 focus:ring-2 focus:ring-emerald-500 focus:outline-none transition text-base">
                            <option value="초등 저학년맘">초등 저학년맘 (초2~4)</option>
                            <option value="특목·자사고 준비맘">특목·자사고 준비맘 (초5~6)</option>
                            <option value="중등 입문맘">중등 입문맘 (중1)</option>
                            <option value="내신 격전지맘">내신 격전지맘 (중2)</option>
                            <option value="고입 최종관문맘">고입 최종관문맘 (중3)</option>
                        </select>
                    </div>

                    <!-- 2. Goal Selection -->
                    <div class="bg-slate-900/50 p-4 rounded-lg border border-emerald-500/30">
                        <h3 class="text-lg font-bold text-emerald-400 mb-3">2. 글 목표 선택</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            <button id="goalBtnConcern" class="text-left p-3 bg-slate-700 hover:bg-slate-600 rounded-lg transition">
                                <span class="text-xl">🤔</span>
                                <span class="font-semibold block mt-1">고민/질문 있어요</span>
                                <p class="text-xs text-slate-400">학습, 진로, 관계에 대한 고민을 나눠요.</p>
                            </button>
                            <button id="goalBtnInfo" class="text-left p-3 bg-slate-700 hover:bg-slate-600 rounded-lg transition">
                                <span class="text-xl">💡</span>
                                <span class="font-semibold block mt-1">유용한 정보 공유</span>
                                <p class="text-xs text-slate-400">KNS 소식, 입시 정보를 공유해요.</p>
                            </button>
                            <button id="goalBtnDaily" class="text-left p-3 bg-slate-700 hover:bg-slate-600 rounded-lg transition">
                                <span class="text-xl">☀️</span>
                                <span class="font-semibold block mt-1">가벼운 일상/유머</span>
                                <p class="text-xs text-slate-400">소소한 이야기로 친목을 다져요.</p>
                            </button>
                            <button id="goalBtnComment" class="text-left p-3 bg-slate-700 hover:bg-slate-600 rounded-lg transition">
                                <span class="text-xl">💬</span>
                                <span class="font-semibold block mt-1">자연스러운 댓글 달기</span>
                                 <p class="text-xs text-slate-400">기존 글에 공감과 의견을 더해요.</p>
                            </button>
                        </div>
                    </div>

                    <!-- Advanced Controls Toggle -->
                    <button id="toggleAdvanced" class="w-full text-sm text-slate-400 hover:text-white py-2 bg-slate-700/50 rounded-lg">⚙️ 전문가 모드 열기</button>
                    
                    <!-- Advanced Controls (Hidden by default) -->
                    <div id="advancedControls" class="hidden space-y-6 pt-4 border-t border-slate-700">
                        <h2 class="text-xl font-bold text-slate-400">전문가 모드 (세부 설정)</h2>
                        
                        <div class="grid grid-cols-2 gap-2">
                            <button id="postModeBtn" class="bg-emerald-500 text-white py-2 px-4 rounded-lg font-medium">📝 글 작성</button>
                            <button id="commentModeBtn" class="bg-slate-700 text-slate-300 py-2 px-4 rounded-lg font-medium">💬 댓글 작성</button>
                        </div>

                        <div id="postTypeSection">
                            <label for="postType" class="block text-sm font-medium text-slate-300 mb-2">글 유형</label>
                            <select id="postType" class="w-full bg-slate-700 border border-slate-600 rounded-lg py-2 px-3 focus:ring-2 focus:ring-emerald-500 focus:outline-none">
                                <option value="SOS형">SOS형 (고민 토로/질문)</option>
                                <option value="공유형">공유형 (정보/경험담)</option>
                                <option value="Q&A형">Q&A형 (단순 문의)</option>
                            </select>
                        </div>

                        <div id="referencePostSection" class="hidden p-4 rounded-lg border border-slate-600 bg-slate-900/50 transition-all duration-200">
                            <label for="referencePost" class="block text-sm font-medium text-slate-300 mb-2">참조할 글 내용</label>
                            <div class="flex items-center gap-2 mb-2">
                                <input type="file" id="ocrImageUpload" accept="image/*" class="hidden">
                                <button id="ocrUploadBtn" class="flex-1 bg-slate-600 text-sm py-1.5 px-3 rounded-md hover:bg-slate-500 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed">파일에서 찾기 🖼️</button>
                            </div>
                            <p id="ocrStatus" class="text-xs text-emerald-400 h-4 mb-1"></p>
                            <textarea id="referencePost" rows="4" class="w-full bg-slate-700 border border-slate-600 rounded-lg py-2 px-3 focus:ring-2 focus:ring-emerald-500 focus:outline-none disabled:bg-slate-800" placeholder="여기에 이미지를 붙여넣거나(Ctrl+V) 파일을 드래그해서 놓아주세요!"></textarea>
                        </div>


                        <div>
                            <label for="category" class="block text-sm font-medium text-slate-300 mb-2">카테고리</label>
                            <select id="category" class="w-full bg-slate-700 border border-slate-600 rounded-lg py-2 px-3 focus:ring-2 focus:ring-emerald-500 focus:outline-none">
                                <option value="KNS 자체 콘텐츠">KNS 자체 콘텐츠</option>
                                <option value="학습법/공부 습관">학습법 / 공부 습관</option>
                                <option value="학교 정보/입시 전략">학교 정보 / 입시 전략</option>
                                <option value="자녀 관계/멘탈 관리">자녀 관계 / 멘탈 관리</option>
                                <option value="학원 생활/시스템 문의">학원 생활 / 시스템 문의</option>
                                <option value="일상/유머">일상 / 유머</option>
                            </select>
                        </div>
                        
                        <div>
                            <label for="postLength" class="block text-sm font-medium text-slate-300 mb-2">글 길이</label>
                            <select id="postLength" class="w-full bg-slate-700 border border-slate-600 rounded-lg py-2 px-3 focus:ring-2 focus:ring-emerald-500 focus:outline-none">
                                <option value="자동">자동 (AI가 판단)</option>
                                <option value="짧게">짧게 (1~3 문장)</option>
                                <option value="보통">보통 (4~7 문장)</option>
                                <option value="길게">길게 (8 문장 이상)</option>
                            </select>
                        </div>
                         <button id="generateBtn" class="w-full bg-sky-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-sky-700 transition-all duration-300">
                            전문가 모드로 생성하기
                        </button>
                    </div>

                    <!-- User Information -->
                    <div class="pt-4 border-t border-slate-700/50">
                        <div class="flex justify-between items-center mb-2">
                            <label for="userName" class="block text-sm font-medium text-slate-300">작성자 정보 (팀 관리용)</label>
                            <button id="regenNameBtn" class="text-xs bg-slate-600 text-slate-300 px-2 py-1 rounded hover:bg-slate-500 transition">다른 닉네임 🔄</button>
                        </div>
                        <input type="text" id="userName" class="w-full bg-slate-700 border border-slate-600 rounded-lg py-2 px-3 focus:ring-2 focus:ring-emerald-500 focus:outline-none" placeholder="자동 생성된 닉네임...">
                    </div>
                </div>
            </div>

            <!-- Output Area -->
            <div class="bg-slate-800 p-6 rounded-2xl shadow-lg border border-slate-700 flex flex-col">
                <div class="flex justify-between items-center border-b border-slate-700 pb-4 mb-6">
                    <h2 class="text-2xl font-bold text-sky-400">생성된 콘텐츠</h2>
                    <div class="flex gap-2">
                        <button id="historyBtn" class="bg-slate-700 text-sm py-1 px-3 rounded-md hover:bg-slate-600">📚 히스토리</button>
                        <button id="statsBtn" class="bg-slate-700 text-sm py-1 px-3 rounded-md hover:bg-slate-600">📊 통계</button>
                        <button id="copyBtn" class="bg-sky-600 text-white text-sm py-1 px-3 rounded-md hover:bg-sky-500 disabled:opacity-50" disabled>수정 완료 & 복사</button>
                    </div>
                </div>
                
                <div id="output" class="flex-grow bg-slate-900/50 p-4 rounded-lg text-slate-300 whitespace-pre-wrap overflow-y-auto leading-relaxed">
                    <div id="placeholder" class="h-full flex items-center justify-center text-slate-500 text-center">
                        <p><span class="font-semibold">1. 페르소나 선택</span> → <span class="font-semibold">2. 글 목표 선택</span><br>클릭 두 번으로 콘텐츠를 만들어보세요!</p>
                    </div>
                    <div id="loading" class="hidden h-full flex items-center justify-center text-slate-500">
                        <svg class="animate-spin -ml-1 mr-3 h-8 w-8 text-emerald-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                        <p>AI가 새로운 페르소나에 빙의하는 중...</p>
                    </div>
                    <div id="result" class="hidden fade-in">
                        <h3 id="resultTitle" class="text-lg font-bold text-sky-300 mb-4"></h3>
                        <div class="flex items-center mb-4"><span id="resultPersonaIcon" class="text-2xl mr-2"></span><span id="resultPersonaName" class="font-semibold"></span></div>
                        <div id="resultBody" contenteditable="true" class="prose prose-invert max-w-none focus:outline-none focus:ring-2 focus:ring-emerald-500 rounded-md p-2 -m-2" placeholder="AI가 생성한 글을 여기에서 바로 수정할 수 있어요!"></div>
                        <div class="mt-4 flex gap-2">
                            <button id="rewriteHookBtn" class="bg-slate-700 text-sm py-1 px-3 rounded-md hover:bg-slate-600">훅 바꾸기</button>
                            <button id="rewriteLineBtn" class="bg-slate-700 text-sm py-1 px-3 rounded-md hover:bg-slate-600">한 줄 바꾸기</button>
                        </div>
                    </div>
                </div>
                 <div class="hidden gap-2 mt-4">
                    <button id="naverLoginBtn" class="flex-1 bg-emerald-600 text-sm text-white py-2 px-3 rounded-md hover:bg-emerald-500">네이버 로그인</button>
                    <button id="naverPostBtn" class="flex-1 bg-sky-600 text-sm text-white py-2 px-3 rounded-md hover:bg-sky-500 disabled:opacity-50" disabled>카페에 올리기</button>
                    <button id="openPostedBtn" class="flex-1 bg-slate-700 text-sm py-2 px-3 rounded-md hover:bg-slate-600 disabled:opacity-50" disabled>게시글 확인</button>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Modals -->
    <div id="historyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4"> <div class="bg-slate-800 rounded-2xl shadow-xl border border-slate-700 w-full max-w-4xl max-h-[80vh] flex flex-col"> <div class="flex justify-between items-center p-6 border-b border-slate-700"> <h3 class="text-2xl font-bold text-sky-400">📚 생성된 콘텐츠 히스토리</h3> <button id="closeHistoryBtn" class="text-slate-400 hover:text-white text-2xl">&times;</button> </div> <div id="historyContent" class="flex-1 overflow-y-auto p-6"> <div id="historyList" class="space-y-4"></div> </div> </div> </div>
    <div id="statsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4"> <div class="bg-slate-800 rounded-2xl shadow-xl border border-slate-700 w-full max-w-5xl max-h-[80vh] flex flex-col"> <div class="flex justify-between items-center p-6 border-b border-slate-700"> <h3 class="text-2xl font-bold text-sky-400">📊 콘텐츠 생성 통계</h3> <button id="closeStatsBtn" class="text-slate-400 hover:text-white text-2xl">&times;</button> </div> <div id="statsContent" class="flex-1 overflow-y-auto p-6"> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div class="bg-slate-700 p-4 rounded-lg"> <h4 class="text-lg font-bold text-emerald-400 mb-4">📈 전체 통계</h4> <div id="overallStats" class="space-y-2"></div> </div> <div class="bg-slate-700 p-4 rounded-lg"> <h4 class="text-lg font-bold text-emerald-400 mb-4">👥 작성자별 통계</h4> <div id="userStats" class="space-y-2"></div> </div> <div class="bg-slate-700 p-4 rounded-lg"> <h4 class="text-lg font-bold text-emerald-400 mb-4">📂 카테고리별 통계</h4> <div id="categoryStats" class="space-y-2"></div> </div> <div class="bg-slate-700 p-4 rounded-lg"> <h4 class="text-lg font-bold text-emerald-400 mb-4">🎭 페르소나별 통계</h4> <div id="personaStats" class="space-y-2"></div> </div> </div> <div class="mt-6 bg-slate-700 p-4 rounded-lg"> <h4 class="text-lg font-bold text-emerald-400 mb-4">🕒 최근 활동</h4> <div id="recentActivity" class="space-y-2"></div> </div> </div> </div> </div>

    <!-- Help Modal -->
    <div id="helpModal" class="fixed inset-0 bg-black bg-opacity-70 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl shadow-xl border border-slate-700 w-full max-w-4xl max-h-[80vh] flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-700">
                <h3 class="text-2xl font-bold text-sky-400">👩‍🏫 KNS 카페 콘텐츠 생성기 사용 설명서</h3>
                <button id="closeHelpBtn" class="text-slate-400 hover:text-white text-2xl">&times;</button>
            </div>
            <div class="flex-1 overflow-y-auto p-6 text-slate-300 leading-relaxed space-y-6">
                <div>
                    <h4 class="text-xl font-bold text-emerald-400 mb-2">🤔 이 툴은 무엇인가요?</h4>
                    <p>KNS 네이버 카페의 게시글과 댓글을 AI를 통해 쉽고 빠르게 만들어 볼 수 있는 도구입니다. 학부모님 같은 느낌의 콘텐츠를 클릭 몇 번만으로 생성할 수 있어요!</p>
                </div>
                <div>
                    <h4 class="text-xl font-bold text-emerald-400 mb-2">🚀 퀵 스타트: 단 2번의 클릭으로!</h4>
                    <ol class="list-decimal list-inside space-y-2">
                        <li><strong>페르소나 선택:</strong> 글을 쓸 학부모님의 학년을 선택하세요.</li>
                        <li><strong>글 목표 선택:</strong> 작성하고 싶은 글(고민/질문, 정보 공유 등) 버튼을 누르세요.</li>
                        <li><strong>끝!</strong> 잠시 기다리면 오른쪽에 AI가 작성한 글이 짠! 하고 나타납니다.</li>
                    </ol>
                </div>
                <div>
                    <h4 class="text-xl font-bold text-emerald-400 mb-2">✨ 주요 기능 완전 정복!</h4>
                    <ul class="space-y-3">
                        <li><strong>랜덤 닉네임:</strong> 접속 시 '익명의 쿼카' 같은 닉네임이 자동 부여돼요. <strong>[다른 닉네임 🔄]</strong> 버튼으로 변경도 가능! 이 닉네임으로 히스토리와 통계가 기록됩니다.</li>
                        <li><strong>댓글 작성을 위한 고급 기능(OCR):</strong> 원본 글을 캡처해서 <strong>붙여넣기(Ctrl+V)</strong>하거나 <strong>드래그 앤 드롭</strong> 해보세요. AI가 이미지 속 글자를 자동으로 입력해줍니다.</li>
                        <li><strong>콘텐츠 수정 및 재활용:</strong> AI가 만든 글은 결과 창에서 바로 수정할 수 있고, <strong>[훅 바꾸기]</strong>, <strong>[한 줄 바꾸기]</strong> 버튼으로 부분 재작성도 가능해요.</li>
                        <li><strong>똑똑한 팀 기능:</strong> <strong>[📚 히스토리]</strong>에서 과거 작업물을 보거나, <strong>[📊 통계]</strong>에서 팀의 작업 현황을 한눈에 파악할 수 있습니다.</li>
                    </ul>
                </div>
                 <div>
                    <h4 class="text-xl font-bold text-emerald-400 mb-2">꿀팁 & FAQ</h4>
                     <p><strong>Q. '전문가 모드'는 뭔가요?</strong><br> A. 글의 길이, 카테고리 등을 더 세밀하게 설정하고 싶을 때 사용해요. 하지만 대부분의 경우 '글 목표 선택' 버튼만으로도 충분합니다!</p>
                     <p class="mt-2"><strong>Q. 제가 만든 글은 어디에 저장되나요?</strong><br> A. 모든 기록은 개인 컴퓨터의 브라우저에만 저장됩니다. 다른 사람과 공유되지 않으니 안심하고 사용하세요.</p>
                </div>
            </div>
        </div>
    </div>
    
    <script src="config.js"></script>
    <script src="app.js"></script>
</body>
</html>

